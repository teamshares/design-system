.tr        { display: table-row; }
.thead     { display: table-header-group; }
.tbody     { display: table-row-group; }
.tfoot     { display: table-footer-group; }
.col       { display: table-column; }
.colgroup  { display: table-column-group; }
.td, .th   { display: table-cell; }
.caption   { display: table-caption; }

.table {
  display: table; border-collapse: collapse;

  /** TODO: Should be using CSS variables from design system */
  --ts-color-row-bg-odd: #8881;
  --ts-color-row-bg-even: #fff1;
  --ts-color-header-row-bg: #ccc;
  --ts-table-row-gap: 0.25rem;
  --ts-table-column-gap: 1rem;
  --ts-table-cell-padding-y: 0.75rem;
  --ts-table-cell-padding-x: calc(var(--ts-table-column-gap)/2);
  --ts-table-th-padding: var(--sl-spacing-x-small, 0.5rem) var(--ts-table-cell-padding-x);
  --ts-table-td-padding: var(--ts-table-cell-padding-y) var(--ts-table-cell-padding-x);

  &.alternating-rows {
    .tr:nth-child(odd) {
      background-color: var(--ts-color-row-bg-odd);
    }

    .tr:nth-child(even) {
      background-color: var(--ts-color-row-bg-even);
    }
  }

  .responsive-row-group, .responsive-column-group {
    @apply contents;
  }

  .responsive-label {
    @apply hidden mr-1;
  }

  &, .thead, .tbody, .tfoot, .tr {
    @apply w-full relative;
  }

  &.sticky-header {
    .thead .tr {
      @apply bg-white sticky top-0 z-10 border-none;
      background-image: repeating-linear-gradient(
        0deg,
        var(--ts-color-gray-300),
        var(--ts-color-gray-300) 1px,
        transparent 1px,
        transparent 1000px
      )
    }
  }

  .tr {
    @apply py-4 border-b border-gray-200;

    &.clickable {
      @apply hover:bg-gray-100 cursor-pointer;
    }
  }

  .th {
    @apply font-semibold whitespace-nowrap;
    padding: var(--ts-table-th-padding);
  }

  .td {
    @apply align-top ts-body-2;
    padding: var(--ts-table-td-padding);

    &:has(sl-icon), &:has(sl-button) {
      @apply align-middle;
    }

    form {
      /* Override Tailwind setting, which adds margin on button_to forms */
      margin-block-end: 0;
    }
  }
}

/**
  * Table container queries
  *
  * Note that these correspond to the Tailwind container breakpoints,
  * but they use max-width instead of min-width (because we're desktop-first)
  *
  @xs	  @container (max-width: 20rem /* 320px )
  @sm	  @container (max-width: 24rem /* 384px )
  @md	  @container (max-width: 28rem /* 448px )
  @lg	  @container (max-width: 32rem /* 512px )
  @xl	  @container (max-width: 36rem /* 576px )
  @2xl	@container (max-width: 42rem /* 672px )
  @3xl	@container (max-width: 48rem /* 768px )
  @4xl	@container (max-width: 56rem /* 896px )
  @5xl	@container (max-width: 64rem /* 1024px )
**/

/** Make the direct parent of any .table.container-xx element a query-eligible container */
*:has(
    > .table.container-xs,
    > .table.container-sm,
    > .table.container-md,
    > .table.container-lg,
    > .table.container-xl,
    > .table.container-2xl,
    > .table.container-3xl,
    > .table.container-4xl,
    > .table.container-5xl
  ) {
  @apply @container;
}

.table.container-xs,
.table.container-sm,
.table.container-md,
.table.container-lg,
.table.container-xl,
.table.container-2xl,
.table.container-3xl,
.table.container-4xl,
.table.container-5xl {
  /** Common across all container sizes, before responsive breakpoint */
  @apply flex-col;

  .responsive-row-group, .responsive-column-group {
    @apply flex-wrap;
    gap: var(--ts-table-row-gap);
  }
}

/**
 * TODO: DRY this via mixin or partial
 * TODO: Add variables for breakpoints
**/
.table.container-xs {
  @container (max-width: 20rem) {
    --ts-table-column-gap: 0;
    &, .tr, .td              { @apply flex; }
    .tr                      { @apply flex-col py-3; }
    .responsive-row-group    { @apply flex flex-row; }
    .responsive-column-group { @apply flex flex-col; }
    .responsive-label        { @apply inline; }
    .thead                   { @apply hidden; }
    .tbody                   { @apply contents; }
    .th                      { @apply hidden; }

    .td {
      @apply py-1 leading-tight;

      &.pos-tr-1 {
        @apply absolute right-0;
        top: calc(var(--ts-table-td-padding-y));
      }

      &.pos-tr-2 {
        @apply absolute right-0;
        top: calc(var(--ts-table-td-padding-y) + 1.5rem);
      }

      &:has(sl-button):last-of-type {
        @apply justify-end mt-3;

        sl-button {
          @apply w-full @md:w-auto;
        }
      }
    }

    sl-button {
      &::part(label) {
        @apply text-sm leading-9;
        padding: 0 var(--ts-spacing-2x-large);
      }

      &::part(base) {
        @apply h-10;
      }
    }
  }
}

.table.container-sm {
  @container (max-width: 24rem) {
    --ts-table-column-gap: 0;
    --ts-table-tr-padding-y: 0.75rem;
    &, .tr, .td              { @apply flex;}
    .tr                      { @apply flex-col py-3; }
    .responsive-row-group    { @apply flex flex-row; }
    .responsive-column-group { @apply flex flex-col; }
    .responsive-label        { @apply inline; }
    .thead                   { @apply hidden; }
    .tbody                   { @apply contents; }
    .th                      { @apply hidden; }

    .td {
      @apply py-1 leading-tight;

      &.pos-tr-1 {
        @apply absolute right-0;
        top: calc(var(--ts-table-td-padding-y));
      }

      &.pos-tr-2 {
        @apply absolute right-0;
        top: calc(var(--ts-table-td-padding-y) + 1.5rem);
      }

      &:has(sl-button):last-of-type {
        @apply justify-end mt-3;

        sl-button {
          @apply w-full @md:w-auto;
        }
      }
    }

    sl-button {
      &::part(label) {
        @apply text-sm leading-9;
        padding: 0 var(--ts-spacing-2x-large);
      }

      &::part(base) {
        @apply h-10;
      }
    }
  }
}

.table.container-md {
  @container (max-width: 28rem) {
    --ts-table-column-gap: 0;
    --ts-table-tr-padding-y: 0.75rem;
    &, .tr, .td              { @apply flex; }
    .tr                      { @apply flex-col py-3; }
    .responsive-row-group    { @apply flex flex-row; }
    .responsive-column-group { @apply flex flex-col; }
    .responsive-label        { @apply inline; }
    .thead                   { @apply hidden; }
    .tbody                   { @apply contents; }
    .th                      { @apply hidden; }

    .td {
      @apply py-1 leading-tight;

      &.pos-tr-1 {
        @apply absolute right-0;
        top: calc(var(--ts-table-td-padding-y));
      }

      &.pos-tr-2 {
        @apply absolute right-0;
        top: calc(var(--ts-table-td-padding-y) + 1.5rem);
      }

      &:has(sl-button):last-of-type {
        @apply justify-end mt-3;

        sl-button {
          @apply w-full @md:w-auto;
        }
      }
    }

    sl-button {
      &::part(label) {
        @apply text-sm leading-9;
        padding: 0 var(--ts-spacing-2x-large);
      }

      &::part(base) {
        @apply h-10;
      }
    }
  }
}

.table.container-lg {
  @container (max-width: 32rem) {
    --ts-table-column-gap: 0;
    --ts-table-tr-padding-y: 0.75rem;
    &, .tr, .td              { @apply flex; }
    .tr                      { @apply flex-col py-3; }
    .responsive-row-group    { @apply flex flex-row; }
    .responsive-column-group { @apply flex flex-col; }
    .responsive-label        { @apply inline; }
    .thead                   { @apply hidden; }
    .tbody                   { @apply contents; }
    .th                      { @apply hidden; }

    .td {
      @apply py-1 leading-tight;

      &.pos-tr-1 {
        @apply absolute right-0;
        top: calc(var(--ts-table-td-padding-y));
      }

      &.pos-tr-2 {
        @apply absolute right-0;
        top: calc(var(--ts-table-td-padding-y) + 1.5rem);
      }

      &:has(sl-button):last-of-type {
        @apply justify-end mt-3;

        sl-button {
          @apply w-full @md:w-auto;
        }
      }
    }

    sl-button {
      &::part(label) {
        @apply text-sm leading-9;
        padding: 0 var(--ts-spacing-2x-large);
      }

      &::part(base) {
        @apply h-10;
      }
    }
  }
}

.table.container-xl {
  @container (max-width: 36rem) {
    --ts-table-column-gap: 0;
    --ts-table-tr-padding-y: 0.75rem;
    &, .tr, .td              { @apply flex; }
    .tr                      { @apply flex-col py-3; }
    .responsive-row-group    { @apply flex flex-row; }
    .responsive-column-group { @apply flex flex-col; }
    .responsive-label        { @apply inline; }
    .thead                   { @apply hidden; }
    .tbody                   { @apply contents; }
    .th                      { @apply hidden; }

    .td {
      @apply py-1 leading-tight;

      &.pos-tr-1 {
        @apply absolute right-0;
        top: calc(var(--ts-table-td-padding-y));
      }

      &.pos-tr-2 {
        @apply absolute right-0;
        top: calc(var(--ts-table-td-padding-y) + 1.5rem);
      }

      &:has(sl-button):last-of-type {
        @apply justify-end mt-3;

        sl-button {
          @apply w-full @md:w-auto;
        }
      }
    }

    sl-button {
      &::part(label) {
        @apply text-sm leading-9;
        padding: 0 var(--ts-spacing-2x-large);
      }

      &::part(base) {
        @apply h-10;
      }
    }
  }  }

.table.container-2xl {
  @container (max-width: 42rem) {
    --ts-table-column-gap: 0;
    --ts-table-tr-padding-y: 0.75rem;
    &, .tr, .td              { @apply flex; }
    .tr                      { @apply flex-col py-3; }
    .responsive-row-group    { @apply flex flex-row; }
    .responsive-column-group { @apply flex flex-col; }
    .responsive-label        { @apply inline; }
    .thead                   { @apply hidden; }
    .tbody                   { @apply contents; }
    .th                      { @apply hidden; }

    .td {
      @apply py-1 leading-tight;

      &.pos-tr-1 {
        @apply absolute right-0;
        top: calc(var(--ts-table-td-padding-y));
      }

      &.pos-tr-2 {
        @apply absolute right-0;
        top: calc(var(--ts-table-td-padding-y) + 1.5rem);
      }

      &:has(sl-button):last-of-type {
        @apply justify-end mt-3;

        sl-button {
          @apply w-full @md:w-auto;
        }
      }
    }

    sl-button {
      &::part(label) {
        @apply text-sm leading-9;
        padding: 0 var(--ts-spacing-2x-large);
      }

      &::part(base) {
        @apply h-10;
      }
    }
  }  }

.table.container-3xl {
  @container (max-width: 48rem) {
    --ts-table-column-gap: 0;
    --ts-table-tr-padding-y: 0.75rem;
    &, .tr, .td              { @apply flex; }
    .tr                      { @apply flex-col py-3; }
    .responsive-row-group    { @apply flex flex-row; }
    .responsive-column-group { @apply flex flex-col; }
    .responsive-label        { @apply inline; }
    .thead                   { @apply hidden; }
    .tbody                   { @apply contents; }
    .th                      { @apply hidden; }

    .td {
      @apply py-1 leading-tight;

      &.pos-tr-1 {
        @apply absolute right-0;
        top: calc(var(--ts-table-td-padding-y));
      }

      &.pos-tr-2 {
        @apply absolute right-0;
        top: calc(var(--ts-table-td-padding-y) + 1.5rem);
      }

      &:has(sl-button):last-of-type {
        @apply justify-end mt-3;

        sl-button {
          @apply w-full @md:w-auto;
        }
      }
    }

    sl-button {
      &::part(label) {
        @apply text-sm leading-9;
        padding: 0 var(--ts-spacing-2x-large);
      }

      &::part(base) {
        @apply h-10;
      }
    }
  }  }

.table.container-4xl {
  @container (max-width: 56rem) {
    --ts-table-column-gap: 0;
    --ts-table-tr-padding-y: 0.75rem;
    &, .tr, .td              { @apply flex; }
    .tr                      { @apply flex-col py-3; }
    .responsive-row-group    { @apply flex flex-row; }
    .responsive-column-group { @apply flex flex-col; }
    .responsive-label        { @apply inline; }
    .thead                   { @apply hidden; }
    .tbody                   { @apply contents; }
    .th                      { @apply hidden; }

    .td {
      @apply py-1 leading-tight;

      &.pos-tr-1 {
        @apply absolute right-0;
        top: calc(var(--ts-table-td-padding-y));
      }

      &.pos-tr-2 {
        @apply absolute right-0;
        top: calc(var(--ts-table-td-padding-y) + 1.5rem);
      }

      &:has(sl-button):last-of-type {
        @apply justify-end mt-3;

        sl-button {
          @apply w-full @md:w-auto;
        }
      }
    }

    sl-button {
      &::part(label) {
        @apply text-sm leading-9;
        padding: 0 var(--ts-spacing-2x-large);
      }

      &::part(base) {
        @apply h-10;
      }
    }
  }
}

.table.container-4xl {
  @container (max-width: 64rem) {
    --ts-table-column-gap: 0;
    --ts-table-tr-padding-y: 0.75rem;
    &, .tr, .td              { @apply flex; }
    .tr                      { @apply flex-col py-3; }
    .responsive-row-group    { @apply flex flex-row; }
    .responsive-column-group { @apply flex flex-col; }
    .responsive-label        { @apply inline; }
    .thead                   { @apply hidden; }
    .tbody                   { @apply contents; }
    .th                      { @apply hidden; }

    .td {
      @apply py-1 leading-tight;

      &.pos-tr-1 {
        @apply absolute right-0;
        top: calc(var(--ts-table-td-padding-y));
      }

      &.pos-tr-2 {
        @apply absolute right-0;
        top: calc(var(--ts-table-td-padding-y) + 1.5rem);
      }

      &:has(sl-button):last-of-type {
        @apply justify-end mt-3;

        sl-button {
          @apply w-full @md:w-auto;
        }
      }
    }

    sl-button {
      &::part(label) {
        @apply text-sm leading-9;
        padding: 0 var(--ts-spacing-2x-large);
      }

      &::part(base) {
        @apply h-10;
      }
    }
  }
}



